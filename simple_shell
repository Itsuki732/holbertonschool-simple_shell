#include "shell.h"

int main(void)
{
    char *buffer;
    size_t size;
    pid_t child;
    char *args[2];

    buffer = NULL;
    size = 0;

    while (1)
    {
        write(STDOUT_FILENO, "#cisfun$ ", 9);

        if (getline(&buffer, &size, stdin) == -1)
        {
            write(STDOUT_FILENO, "\n", 1);
            free(buffer);
            exit(0);
        }

        buffer[strcspn(buffer, "\n")] = '\0';

        if (buffer[0] == '\0')
            continue;

        child = fork();

        if (child == 0)
        {
            args[0] = buffer;
            args[1] = NULL;

            execve(args[0], args, environ);
            perror("./shell");
            exit(1);
        }
        else if (child > 0)
        {
            wait(NULL);
        }
    }
}
